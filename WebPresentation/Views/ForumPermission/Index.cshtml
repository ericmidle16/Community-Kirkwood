<!--
    /// <summary>
    /// Creator: Syler Bushlack
    /// Created: 2025-04-24
    /// Summary: View Forum Permissions
    ///
    /// Updated By: Skyann Heintz
    /// Updated: 2025-04-28
    /// What Was Changed: Styling was added
    ///
    /// Updated By: Dat Tran
    /// Updated: 2025-04-27
    /// What Was Changed: Sweet Alert implementation for muting and unmuting a user.
    ///
    /// Updated By: Skyann Heintz
    /// Updated: 2025-04-30
    /// What Was Changed: Ensured there was space between words
    
-->

@model IEnumerable<DataDomain.ForumPermissionVM>

@{
    ViewData["Title"] = "Index";
    int projectID = ViewBag.ProjectID;
}


<h1 class="text-center">All Forum Permissions</h1>
@*


*@
@if (TempData["MuteUser"] != null)
{
    <script>
        document.addEventListener("DOMContentLoaded", function () {

            if(!sessionStorage.getItem('sweetAlertMuteUserShown')){
            Swal.fire({
                icon: 'success',
                title: 'Done',
                text: '@TempData["MuteUser"]'
                });
                sessionStorage.setItem('sweetAlertMuteUserShown', 'true');
            }
        });
    </script>
    @* Remove the message so it doesn’t persist on refresh *@
    TempData.Remove("MuteUser");

}
else
{
    <script>
        // Ensure the flag is reset if there's no success message
        sessionStorage.removeItem('sweetAlertMuteUserShown');
    </script>
}
@if (TempData["UnmuteUser"] != null)
{
    <script>
        document.addEventListener("DOMContentLoaded", function () {

            if(!sessionStorage.getItem('sweetAlertUnmuteUserShown')){
            Swal.fire({
                icon: 'success',
                title: 'Done',
                text: '@TempData["UnmuteUser"]'
                });
                sessionStorage.setItem('sweetAlertUnmuteUserShown', 'true');
            }
        });
    </script>
    @* Remove the message so it doesn’t persist on refresh *@
    TempData.Remove("UnmuteUser");

}
else
{
    <script>
        // Ensure the flag is reset if there's no success message
        sessionStorage.removeItem('sweetAlertUnmuteUserShown');
    </script>
}

<p>
    @Html.ActionLink("Back to Project Forum", "ViewProjectForum", "Forum", new { id = projectID }, new { @class = "btn btn-secondary" })
</p>
<table class="table table-striped table-bordered table-hover">
    <thead class="thead-dark">
        <tr>
            <th class="header">
                Given Name
            </th>
            <th class="header">
                Write Access
            </th>
        </tr>
    </thead>
    <tbody>
        @foreach (var item in Model)
        {
            <tr>
                <td>
                    @Html.DisplayFor(modelItem => item.GivenName)
                </td>
                <td>
                    @if (item.WriteAccess)
                    {
                        @Html.ActionLink("Mute", "Mute", new { projectID = projectID, userID = item.UserID, writeAccess = false }, new { @class = "btn btn-warning btn-sm" })
                        ;
                    }
                    else
                    {
                        @Html.ActionLink("Unmute", "Mute", new { projectID = projectID, userID = item.UserID, writeAccess = true }, new { @class = "btn btn-warning btn-sm" })
                        ;
                    }
                </td>
            </tr>
        }
    </tbody>
</table>
